{
  "hash": "1bc6fe552c70ac54d98b30b46422f30e",
  "result": {
    "engine": "knitr",
    "markdown": "# Intro to Regressions {#sec-regression}\n\n\n\n::: callout-important\n**This section is still under construction**\n:::\n\nStatistical modeling can be counter intuitive, so let’s pause and clarify what we want to achieve before jumping into details.\n\nFirst, we’ll discuss why we use regression: what’s the purpose, and what does it help us understand? Next, we’ll explore the idea of a “model” in regression, emphasizing that—just as with statistical tests—your decisions about representing data influence your results. Finally, we’ll wrap up with some practical advice, though we’ll only scratch the surface of this rich topic.\n\n## What can regression models do for you? {#sec-reg_purpose}\n\nRegression models have multiple uses; it’s helpful to clarify your goal upfront. One intuitive way to think about their purpose is by grouping them into three main types: descriptive, predictive, or causal (as described in https://onlinelibrary.wiley.com/doi/full/10.1002/sim.10244)\n\nConsider a regression model that predicts **weight** based on **age**, **sex**, and **height**. Depending on your objective, you might ask different questions:\n\n| Purpose | Example Question | Goal |\n|----|----|----|\n| Descriptive | “For every extra inch of height, how much heavier is someone on average (after adjusting for age and sex)?” | Summarize patterns you’ve already observed |\n| Predictive | “If I meet a 40-year-old man who is 5′10″, how much should I expect him to weigh?” | Make reliable guesses about unseen data |\n| Causal | “If I became two inches taller, how would my weight change?” | Test a hypothesis about cause-and-effect |\n\nResearchers typically specify clearly when they’re making predictions, but they often blur the lines between descriptive and causal statements. For example, you’ll frequently see euphemisms like “linked to” or “associated with,” followed by suggestions that changing a predictor could influence the outcome. This confusion between description and causation is a widespread issue(academic.oup.com/aje/article/191/12/2084/6655746). Don’t add to it. If your goal is to understand cause-and-effect relationships, communicate that.\n\n### When should you adjust your estimate? {#sec-when_adjust}\n\nTo understand when \"adjusting\" for other variables helps and when it doesn't, it’s essential to distinguish clearly between three related concepts: confounding, effect modification (or, similarly, interactions), and mediation. All three describe ways a third variable can influence the relationship between an **Exposure (E)** and an **Outcome (O)**.\n\nWe’ll use Directed Acyclic Graphs (DAGs) to illustrate these concepts. DAGs visually represent your assumptions about how variables relate to each other. These are assumptions you assume for the purpose of your analysis, rather than directly test. You can create DAGs using tools like Dagitty (www.dagitty.com), the dagitty/diagrameR packages (R), dag (STATA) or Python’s Graphviz package.)\n\nDAG reference: <https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7124493/> \n\n#### Confounders {#sec-confounder}\n\nA confounder (abbreviated, C) is a variable that is associated with the exposure, precedes it, and also independently affects the outcome.\n\nConsider this example: you're interested in how the severity of hypercapnia during acute hypercapnic respiratory failure influences readmission risk (a causal question).\n\n| Role | Variable | Description |\n|----|----|----|\n| **Exposure (E)** | Severity of hypercapnia | Higher PaCO₂ indicates more severe hypercapnia |\n| **Outcome (O)** | Readmission risk | Whether the patient is readmitted within 28 days |\n| **Confounder (C)** | Disease severity | Overall illness severity (e.g., FEV₁) |\n\n\n\nUsing the python GraphViz package, this DAG can be visualized as\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\ng = gr.Digraph()\n\ng.edge(\"Disease Severity (C)\", \"Hypercapnia Severity (E)\")\ng.edge(\"Disease Severity (C)\", \"Readmission Risk (O)\")\ng.edge(\"Hypercapnia Severity (E)\", \"Readmission Risk (O)\")\n\nsvg = g.pipe(format=\"svg\").decode(\"utf-8\")  \nHTML(svg)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 13.1.0 (0)\n -->\n<!-- Pages: 1 -->\n<svg width=\"274pt\" height=\"188pt\"\n viewBox=\"0.00 0.00 274.00 188.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 184)\">\n<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-184 270.43,-184 270.43,4 -4,4\"/>\n<!-- Disease Severity (C) -->\n<g id=\"node1\" class=\"node\">\n<title>Disease Severity (C)</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"172.6\" cy=\"-162\" rx=\"87.69\" ry=\"18\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"172.6\" y=\"-156.95\" font-family=\"Times,serif\" font-size=\"14.00\">Disease Severity (C)</text>\n</g>\n<!-- Hypercapnia Severity (E) -->\n<g id=\"node2\" class=\"node\">\n<title>Hypercapnia Severity (E)</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"105.6\" cy=\"-90\" rx=\"105.6\" ry=\"18\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"105.6\" y=\"-84.95\" font-family=\"Times,serif\" font-size=\"14.00\">Hypercapnia Severity (E)</text>\n</g>\n<!-- Disease Severity (C)&#45;&gt;Hypercapnia Severity (E) -->\n<g id=\"edge1\" class=\"edge\">\n<title>Disease Severity (C)&#45;&gt;Hypercapnia Severity (E)</title>\n<path fill=\"none\" stroke=\"black\" d=\"M156.38,-144.05C148.32,-135.63 138.41,-125.28 129.5,-115.97\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"132.16,-113.69 122.72,-108.88 127.11,-118.53 132.16,-113.69\"/>\n</g>\n<!-- Readmission Risk (O) -->\n<g id=\"node3\" class=\"node\">\n<title>Readmission Risk (O)</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"172.6\" cy=\"-18\" rx=\"93.83\" ry=\"18\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"172.6\" y=\"-12.95\" font-family=\"Times,serif\" font-size=\"14.00\">Readmission Risk (O)</text>\n</g>\n<!-- Disease Severity (C)&#45;&gt;Readmission Risk (O) -->\n<g id=\"edge2\" class=\"edge\">\n<title>Disease Severity (C)&#45;&gt;Readmission Risk (O)</title>\n<path fill=\"none\" stroke=\"black\" d=\"M193.81,-144.25C204,-134.83 215.16,-122.13 220.6,-108 226.36,-93.07 226.36,-86.93 220.6,-72 216.63,-61.71 209.64,-52.17 202.19,-44.11\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"204.68,-41.65 195.13,-37.05 199.73,-46.6 204.68,-41.65\"/>\n</g>\n<!-- Hypercapnia Severity (E)&#45;&gt;Readmission Risk (O) -->\n<g id=\"edge3\" class=\"edge\">\n<title>Hypercapnia Severity (E)&#45;&gt;Readmission Risk (O)</title>\n<path fill=\"none\" stroke=\"black\" d=\"M121.82,-72.05C129.89,-63.63 139.79,-53.28 148.71,-43.97\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"151.1,-46.53 155.49,-36.88 146.04,-41.69 151.1,-46.53\"/>\n</g>\n</g>\n</svg>\n```\n\n:::\n:::\n\n\nIn this example, you can imagine an example where there appears to be an association between hypercapnia severity and risk of readmission, even if - hypothetically - there isn't one, if patients who have more severe lung disease tend to have higher PaCO₂ levels. Thus, to isolate the effect of hypercapnia itself, you need to account for the severity of lung disease.\n\n#### Mediators {#sec-mediator}\n\nNext, consider CO₂ narcosis (altered mental status from severe hypercapnia). Should we adjust for CO₂ narcosis when estimating the impact of hypercapnia on outcomes like readmission risk?\n\nCO₂ narcosis clearly meets some criteria for adjustment: it’s associated with both hypercapnia (the exposure) and readmission risk (the outcome). But, CO₂ narcosis doesn’t cause hypercapnia; it’s a consequence of it. This makes CO₂ narcosis a mediator (abbreviated M), rather than a confounder.\n\nA mediator is a variable that is on the causal pathway between exposure and outcome. Mediators never cause the exposure, nor do they result from the outcome. Instead, they represent a step through which the exposure affects the outcome.\n\n| Role | Variable / Example | Description |\n|----|----|----|\n| **Exposure (E)** | Severity of hypercapnia | Baseline PaCO₂ level on admission |\n| **Mediator (M)** | CO₂ narcosis (altered mental status) | Developed after hypercapnia; lies on path between E and O |\n| **Outcome (O)** | Readmission risk | Whether the patient is readmitted within 28 days |\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\ng = gr.Digraph()\n\ng.edge(\"Hypercapnia Severity (E)\", \"Altered Mental Status (M)\")\ng.edge(\"Altered Mental Status (M)\", \"Readmission Risk (O)\")\ng.edge(\"Hypercapnia Severity (E)\", \"Readmission Risk (O)\")\n\nsvg = g.pipe(format=\"svg\").decode(\"utf-8\")  \nHTML(svg)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 13.1.0 (0)\n -->\n<!-- Pages: 1 -->\n<svg width=\"293pt\" height=\"188pt\"\n viewBox=\"0.00 0.00 293.00 188.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 184)\">\n<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-184 288.81,-184 288.81,4 -4,4\"/>\n<!-- Hypercapnia Severity (E) -->\n<g id=\"node1\" class=\"node\">\n<title>Hypercapnia Severity (E)</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"179.21\" cy=\"-162\" rx=\"105.6\" ry=\"18\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"179.21\" y=\"-156.95\" font-family=\"Times,serif\" font-size=\"14.00\">Hypercapnia Severity (E)</text>\n</g>\n<!-- Altered Mental Status (M) -->\n<g id=\"node2\" class=\"node\">\n<title>Altered Mental Status (M)</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"110.21\" cy=\"-90\" rx=\"110.21\" ry=\"18\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"110.21\" y=\"-84.95\" font-family=\"Times,serif\" font-size=\"14.00\">Altered Mental Status (M)</text>\n</g>\n<!-- Hypercapnia Severity (E)&#45;&gt;Altered Mental Status (M) -->\n<g id=\"edge1\" class=\"edge\">\n<title>Hypercapnia Severity (E)&#45;&gt;Altered Mental Status (M)</title>\n<path fill=\"none\" stroke=\"black\" d=\"M162.51,-144.05C154.32,-135.75 144.3,-125.58 135.22,-116.38\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"137.81,-114.02 128.3,-109.35 132.83,-118.93 137.81,-114.02\"/>\n</g>\n<!-- Readmission Risk (O) -->\n<g id=\"node3\" class=\"node\">\n<title>Readmission Risk (O)</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"179.21\" cy=\"-18\" rx=\"93.83\" ry=\"18\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"179.21\" y=\"-12.95\" font-family=\"Times,serif\" font-size=\"14.00\">Readmission Risk (O)</text>\n</g>\n<!-- Hypercapnia Severity (E)&#45;&gt;Readmission Risk (O) -->\n<g id=\"edge3\" class=\"edge\">\n<title>Hypercapnia Severity (E)&#45;&gt;Readmission Risk (O)</title>\n<path fill=\"none\" stroke=\"black\" d=\"M201.81,-143.96C212.27,-134.63 223.61,-122.11 229.21,-108 235.12,-93.13 235.12,-86.87 229.21,-72 225.02,-61.44 217.61,-51.77 209.76,-43.66\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"212.29,-41.23 202.64,-36.85 207.45,-46.29 212.29,-41.23\"/>\n</g>\n<!-- Altered Mental Status (M)&#45;&gt;Readmission Risk (O) -->\n<g id=\"edge2\" class=\"edge\">\n<title>Altered Mental Status (M)&#45;&gt;Readmission Risk (O)</title>\n<path fill=\"none\" stroke=\"black\" d=\"M126.91,-72.05C135.22,-63.63 145.42,-53.28 154.6,-43.97\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"157.07,-46.45 161.6,-36.87 152.09,-41.53 157.07,-46.45\"/>\n</g>\n</g>\n</svg>\n```\n\n:::\n:::\n\n\nIf we include CO₂ narcosis in our regression model, what happens?\n\nThink of it this way: hypercapnia may influence readmission risk in two distinct ways:\n\n-   Indirect pathway: Hypercapnia → CO₂ narcosis → readmission. This is the effect that is mediated through M)\n-   Direct pathway: Hypercapnia → readmission through other mechanisms (not involving M)\n\nIncluding CO₂ narcosis in the model removes (“controls out”) the indirect pathway. In other words, the regression result would represent only the effect of hypercapnia independent of CO₂ narcosis (the direct effect\\*).\n\nTypically, we’re interested in the entire impact of hypercapnia on outcomes, the total effect, which includes both direct and indirect pathways. Thus, you usually should avoid including mediators in your regression models.\n\n::: {.callout-note collapse=\"true\"}\n## Additional assumptions for valid mediation analysis\n\nIn the case where you really are interested in splitting apart the direct and indirect pathways, there are a few additional assumptions for a valid mediation analysis, collectively termed **sequential ignorability**. They include:\n\n-   No unmeasured confounding for the relationships:\n    -   E → O\n    -   E → M\n    -   M → O\n-   No confounders of the M → O relationship are caused by E\n:::\n\nSimilarly, there are other variables which are neither confounders nor mediators (such as variables merely correlated with the mediator or variables that result from the outcome) that will cause confusion and yield misleading or uninterpretable results if they're included in regression models.\n\n#### Effect Modifier {#sec-effect_mod}\n\nAn effect modifier (often abbreviated Z) is a third variable that changes (modifies) the strength or direction of the relationship between an exposure (E) and an outcome (O).\n\nReturning to our example, imagine that the relationship between hypercapnia and readmission risk depends on the patient’s primary diagnosis:\n\n• In COPD, elevated PaCO₂ may cause persistent impairment of respiratory drive, increasing the likelihood of readmission despite therapy.\n\n• In Obesity Hypoventilation Syndrome (OHS), elevated PaCO₂ may respond effectively to nocturnal BPAP therapy, making readmissions less likely.\n\nThus, the impact of hypercapnia on readmission risk differs depending on whether the patient has COPD or OHS. In other words, the primary diagnosis *modifies* the effect of hypercapnia on readmission risk, making it an effect modifier.\n\n| Role | Variable | Description |\n|----|----|----|\n| **Exposure (E)** | Severity of hypercapnia | PaCO₂ level at admission |\n| **Effect modifier (Z)** | Primary diagnosis | COPD vs OHS alters how PaCO₂ influences readmission risk |\n| **Outcome (O)** | Readmission Risk | Whether the patient returns within 28 days |\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\ng = gr.Digraph()\n\ng.edge(\"Hypercapnia Severity\", \"Altered Mental Status\")\ng.edge(\"Altered Mental Status\", \"Readmission Risk\")\ng.edge(\"Hypercapnia Severity\", \"Readmission Risk\")\n\nsvg = g.pipe(format=\"svg\").decode(\"utf-8\")  \nHTML(svg)\n\n# Note: there is not a uniformly agreed upon way to represent an effect modifiers in DAG, though there are proposals\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 13.1.0 (0)\n -->\n<!-- Pages: 1 -->\n<svg width=\"252pt\" height=\"188pt\"\n viewBox=\"0.00 0.00 252.00 188.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 184)\">\n<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-184 248.08,-184 248.08,4 -4,4\"/>\n<!-- Hypercapnia Severity -->\n<g id=\"node1\" class=\"node\">\n<title>Hypercapnia Severity</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"152.81\" cy=\"-162\" rx=\"91.27\" ry=\"18\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"152.81\" y=\"-156.95\" font-family=\"Times,serif\" font-size=\"14.00\">Hypercapnia Severity</text>\n</g>\n<!-- Altered Mental Status -->\n<g id=\"node2\" class=\"node\">\n<title>Altered Mental Status</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"92.81\" cy=\"-90\" rx=\"92.81\" ry=\"18\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"92.81\" y=\"-84.95\" font-family=\"Times,serif\" font-size=\"14.00\">Altered Mental Status</text>\n</g>\n<!-- Hypercapnia Severity&#45;&gt;Altered Mental Status -->\n<g id=\"edge1\" class=\"edge\">\n<title>Hypercapnia Severity&#45;&gt;Altered Mental Status</title>\n<path fill=\"none\" stroke=\"black\" d=\"M138.28,-144.05C131.13,-135.71 122.37,-125.49 114.45,-116.25\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"117.35,-114.25 108.18,-108.94 112.03,-118.81 117.35,-114.25\"/>\n</g>\n<!-- Readmission Risk -->\n<g id=\"node3\" class=\"node\">\n<title>Readmission Risk</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"152.81\" cy=\"-18\" rx=\"78.48\" ry=\"18\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"152.81\" y=\"-12.95\" font-family=\"Times,serif\" font-size=\"14.00\">Readmission Risk</text>\n</g>\n<!-- Hypercapnia Severity&#45;&gt;Readmission Risk -->\n<g id=\"edge3\" class=\"edge\">\n<title>Hypercapnia Severity&#45;&gt;Readmission Risk</title>\n<path fill=\"none\" stroke=\"black\" d=\"M170.97,-144.22C180.02,-134.61 190.02,-121.75 194.81,-108 200.07,-92.89 200.07,-87.11 194.81,-72 191.33,-62.01 185.1,-52.49 178.48,-44.34\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"181.19,-42.13 171.97,-36.91 175.93,-46.74 181.19,-42.13\"/>\n</g>\n<!-- Altered Mental Status&#45;&gt;Readmission Risk -->\n<g id=\"edge2\" class=\"edge\">\n<title>Altered Mental Status&#45;&gt;Readmission Risk</title>\n<path fill=\"none\" stroke=\"black\" d=\"M107.33,-72.05C114.48,-63.71 123.24,-53.49 131.16,-44.25\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"133.58,-46.81 137.43,-36.94 128.27,-42.25 133.58,-46.81\"/>\n</g>\n</g>\n</svg>\n```\n\n:::\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n## Scale matters in effect modification\n\nWhether there's effect modification depends on **scale**:\n\n| Scale | Question answered | Possible outcome |\n|----|----|----|\n| **Relative** (e.g., risk ratio, odds ratio) | “Does the *proportional* effect differ by subgroup?” | Subgroups may differ on the RR scale but not on the additive scale. |\n| **Additive** (e.g., risk difference) | “Does the *absolute* effect differ by subgroup?” | Effect modifiers can disappear (or appear) when you switch scales. |\n\nThere is not consensus about which is preferred. Generalizing, relative effect modification better captures biologic interactions while absolute effect modification better captures the implications for decision-making. Always state the scale (relative effect modification vs. absolute effect modification) and remember that a modifier on one scale may vanish on another.\n:::\n\nWhat happens if you include an effect modifier as a regular predictor in your regression model?\n\nUnfortunately, you don’t capture the relationship you’re interested in, as the model would provide:\n\n• An estimate of how diagnosis (COPD vs OHS) influences readmission risk, after adjusting for PaCO₂. • A single, averaged estimate of how PaCO₂ influences readmission risk, after adjusting for the primary diagnosis.\n\nWhat you really want is to represent how the effect of PaCO₂ differs depending on the diagnosis: two distinct estimates rather than a single averaged effect. To accomplish that, you must explicitly include an interaction term (e.g., PaCO2 × diagnosis) in your regression model.\n\nBecause regression models represent effect modification through interaction terms, the terms effect modification and interaction are often used semi-interchangeably.\n\n::: {.callout-note collapse=\"true\"}\n## Interactions need more power\n\nExpect to need **much larger sample sizes** (4-16 ×) to detect interactions with the same confidence you’d expect for main effects:\n\n-   **Interactions are usually smaller** than main effects.\\\n-   You’re separating the signal from **two variables at once** (exposure × modifier), so standard errors inflate.\n\nEven so, you should include the interaction term in your plan if biological or clinical reasoning suggests effect modification... just remember that it's not very strong evidence against effect modification if the interaction term is not statistically significant.\n:::\n\n### So, what should go in your regression model? {#sec-variable_select}\n\nWe’ve discussed three ways that a third variable can influence the relationship between an exposure and an outcome:\n\n```         \n•   Confounding (C)\n•   Mediation (M)\n•   Effect Modification (Z)\n```\n\nEach scenario changes the meaning of your regression results. Whether and how you include these variables depends entirely on what you’re trying to measure—your estimand—and your assumptions about how each variable fits into the causal structure.\n\nHere’s the critical takeaway: **You can’t determine the role of variables just by looking at the data.**\\*\n\nConfounders, mediators, and modifiers can all appear very similar in raw data. Instead, you must carefully reason through the role each variable plays in your scenario, clearly define your estimand, and then build a model that matches these assumptions. Directed Acyclic Graphs (DAGs) help you explicitly lay out and communicate these assumptions, clarifying your model-building decisions.\n\nThe need to explicitly define assumptions has important implications for how you should build regression models. Most importantly:\n\nDo NOT simply include all available variables in your model and hope for the best.\n\nEven with large datasets, including too many predictors without careful thought can obscure what your results actually mean, or worse, mislead you entirel. To emphasize the point clearly:\n\n***Do NOT just throw everything into your regression model.***\n\nTo drive this home, the next section (optional) introduces a fourth type of variable, called a collider, illustrating even more clearly why careful selection of variables matters.\n\n::: {.callout-warning collapse=\"true\"}\n## Why do tall NBA players appear to be bad at free throws?\n\nThis surprising observation illustrates **collider(-stratification) bias**. A **collider** is a variable influenced by two (or more) other variables. Adjusting for (or restricting your analysis to a certain value of) a collider can create artificial associations that don't exist in reality.\n\n**Example: NBA Player Selection**\n\n-   Being tall → more likely to become an NBA player\\\n-   Having excellent free-throw accuracy → more likely to become an NBA player\n\nThus, \"NBA player\" is a **collider**—it results from both height and shooting accuracy:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\ng = gr.Digraph()\n\ng.edge(\"Being very tall\", \"Drafted into NBA\")\ng.edge(\"Excellent free-throw accuracy\", \"Drafted into NBA\")\n\nsvg = g.pipe(format=\"svg\").decode(\"utf-8\")  \nHTML(svg)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 13.1.0 (0)\n -->\n<!-- Pages: 1 -->\n<svg width=\"404pt\" height=\"116pt\"\n viewBox=\"0.00 0.00 404.00 116.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 112)\">\n<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-112 399.69,-112 399.69,4 -4,4\"/>\n<!-- Being very tall -->\n<g id=\"node1\" class=\"node\">\n<title>Being very tall</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"66.19\" cy=\"-90\" rx=\"66.19\" ry=\"18\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"66.19\" y=\"-84.95\" font-family=\"Times,serif\" font-size=\"14.00\">Being very tall</text>\n</g>\n<!-- Drafted into NBA -->\n<g id=\"node2\" class=\"node\">\n<title>Drafted into NBA</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"169.19\" cy=\"-18\" rx=\"77.97\" ry=\"18\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"169.19\" y=\"-12.95\" font-family=\"Times,serif\" font-size=\"14.00\">Drafted into NBA</text>\n</g>\n<!-- Being very tall&#45;&gt;Drafted into NBA -->\n<g id=\"edge1\" class=\"edge\">\n<title>Being very tall&#45;&gt;Drafted into NBA</title>\n<path fill=\"none\" stroke=\"black\" d=\"M90.08,-72.76C103.64,-63.55 120.81,-51.88 135.69,-41.77\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"137.52,-44.76 143.83,-36.24 133.59,-38.97 137.52,-44.76\"/>\n</g>\n<!-- Excellent free&#45;throw accuracy -->\n<g id=\"node3\" class=\"node\">\n<title>Excellent free&#45;throw accuracy</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"273.19\" cy=\"-90\" rx=\"122.49\" ry=\"18\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"273.19\" y=\"-84.95\" font-family=\"Times,serif\" font-size=\"14.00\">Excellent free&#45;throw accuracy</text>\n</g>\n<!-- Excellent free&#45;throw accuracy&#45;&gt;Drafted into NBA -->\n<g id=\"edge2\" class=\"edge\">\n<title>Excellent free&#45;throw accuracy&#45;&gt;Drafted into NBA</title>\n<path fill=\"none\" stroke=\"black\" d=\"M248.02,-72.05C234.51,-62.96 217.67,-51.63 203.03,-41.77\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"205.28,-39.07 195.03,-36.39 201.38,-44.88 205.28,-39.07\"/>\n</g>\n</g>\n</svg>\n```\n\n:::\n:::\n\n\nWhen you look *only* at NBA players (essentially, 'adjusting for' the collider), you create an artificial, inverse relationship: it looks like taller players are poorer free-throw shooters, even if no real-world correlation exists. In reality, what you're finding is: \"there's two ways to get into the NBA. So, folks who got in because they're good shooters are probably less tall and people who got in because they're tall are likely worse shooter.\"\n\n**Takeaway**: Conditioning on a collider distorts reality. Carefully identify colliders in your DAG, and **avoid adjusting for them**.\n\nThis may seem niche, but collider-stratification is everywhere, once you look for it. The \"obesity paradox\" is one medical example. Consider ARDS.\n\nYou must be very hypoxemic to have ARDS. There are two reasons you might be hypoxemic:\n\n-   obesity, leading to atelectasis and shunting\n-   severe lung injury\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\ng = gr.Digraph()\n\ng.edge(\"Obesity\", \"Hypoxemia\")\ng.edge(\"Lung Injury\", \"Hypoxemia\")\n\nsvg = g.pipe(format=\"svg\").decode(\"utf-8\")  \nHTML(svg)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 13.1.0 (0)\n -->\n<!-- Pages: 1 -->\n<svg width=\"216pt\" height=\"116pt\"\n viewBox=\"0.00 0.00 216.00 116.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 112)\">\n<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-112 212.03,-112 212.03,4 -4,4\"/>\n<!-- Obesity -->\n<g id=\"node1\" class=\"node\">\n<title>Obesity</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"39.58\" cy=\"-90\" rx=\"39.58\" ry=\"18\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"39.58\" y=\"-84.95\" font-family=\"Times,serif\" font-size=\"14.00\">Obesity</text>\n</g>\n<!-- Hypoxemia -->\n<g id=\"node2\" class=\"node\">\n<title>Hypoxemia</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"95.58\" cy=\"-18\" rx=\"54.42\" ry=\"18\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"95.58\" y=\"-12.95\" font-family=\"Times,serif\" font-size=\"14.00\">Hypoxemia</text>\n</g>\n<!-- Obesity&#45;&gt;Hypoxemia -->\n<g id=\"edge1\" class=\"edge\">\n<title>Obesity&#45;&gt;Hypoxemia</title>\n<path fill=\"none\" stroke=\"black\" d=\"M52.57,-72.76C59.26,-64.4 67.57,-54.02 75.1,-44.61\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"77.81,-46.81 81.33,-36.82 72.35,-42.44 77.81,-46.81\"/>\n</g>\n<!-- Lung Injury -->\n<g id=\"node3\" class=\"node\">\n<title>Lung Injury</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"152.58\" cy=\"-90\" rx=\"55.45\" ry=\"18\"/>\n<text xml:space=\"preserve\" text-anchor=\"middle\" x=\"152.58\" y=\"-84.95\" font-family=\"Times,serif\" font-size=\"14.00\">Lung Injury</text>\n</g>\n<!-- Lung Injury&#45;&gt;Hypoxemia -->\n<g id=\"edge2\" class=\"edge\">\n<title>Lung Injury&#45;&gt;Hypoxemia</title>\n<path fill=\"none\" stroke=\"black\" d=\"M139.07,-72.41C132.26,-64.04 123.84,-53.71 116.24,-44.37\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"118.98,-42.19 109.95,-36.64 113.55,-46.61 118.98,-42.19\"/>\n</g>\n</g>\n</svg>\n```\n\n:::\n:::\n\n\nSo, if you look at people with ARDS (essentially, conditioning on hypoxemia), you expect a negative relationship between BMI and the degree of lung injury. When people unfamiliar with collider-stratification find that relationship, they look for explanations about \"the protective effect of obesity\". Doubtful there is such a thing.\n:::\n\nWhat you should do instead (as endorsed by the editors of all the main PCCM journals) is before you even look at your data, sit down and think through the relationship between your exposure of interest and your outcome of interest and start creating a DAG.\n\n-   What things are confounders (even if you can't measure them, including them in the diagram because it'll help clarify what residual confounders will be left after you've constructed your best model, which will undoubtedly be imperfect)?\n-   Consider what the thing you're interested in estiamting is (is it the total effect?), and what things are mediators?\n-   What things might modify the effect of interest?\n\nOnce your diagram is done, it implies what your ideal regression model might be. Include only the variables that seem important in your DAG. Then, you have to further consider the limitations of the data (ie. size, how well each can be measured), and decide which confounders can be adjusted for under the actual constraints in your project.\n\n::: {.callout-warning collapse=\"true\"}\n## How does sample size limit what can be in a regression?\n\nThink of regression as trying to pull signal (the actual underlying relationships) out of noise (randomness from comes from only having a few, imperfectly measured data points).\n\nConsider the case where there's one predictor, two points. With just two data points you can always draw a line (fit a model) that fits perfectly... but the “fit” is meaningless. Same thing occurs if there's two predictors, three points. In three-dimensional space you can always fit a plane exactly through three points—for the same reason. In both cases, the perfect fit just reflects that if you give yourself enough degrees of freedom, you can perfectly fit your data, but it may not reflect the underlying trends. The model memorizes random noise instead of learning the underlying relationship.\n\nMany rules of thumb (and more rigorous appraoches) exist to determine how many predictors is too many.\n\nIt's better to err on the side of including less.\n:::\n\nThen, finally, you can run your regression.\n\n## The logic of using regression for causal inference {#sec-regression_logic}\n\nRecall that when we observe an association between an exposure and an outcome, there are four possible explanations:\n\n```         \n1.  Chance\n2.  Confounding (another factor influencing both exposure and outcome)\n3.  Bias (systematic error resulting from measurement or design)\n4.  Causation (a true effect)\n```\n\nWhen we use regression for causal inference, we’re typically making an argument by exclusion (the disjunctive syllogism):\n\n> If chance, confounding, and bias can’t explain the association, it must be causal.\n\nThe probability of chance alone explaining an observed observation is the p-value. The plausibility that bias could explain it is addressed by the methods of the paper (how the study was designed and how the effects were measured).\n\nIn randomized studies, random assignment makes confounding improbable (if the sample is big enough). However, in observational (non-randomized) research, statistical adjustments to address the possibility of confounding are required. This is the most common use of regression.\n\nHowever, for regression to adequately adjust for confounders (ie. confounders are )\n\nRegression comes with additional assumptions: \n\n-   Independent observations (special \"mixed models\" can relax this)\n-   The form of the output variable is correct\\* \n-   The form of the predictor variables are correct\n-   The relationship between the predictors are properly specified.\\*\\*\n-   Additional constraints (e.g. constant variance)\n\nLastly, all potential confounders must be in the model (an assumption called 'conditional exchangeability')\n\nThus the logic is: if the assumptions of the models hold in reality, then the described relationships are valid\n\n> No model is perfect, but some models are useful\n\n-   Morris moment(TM)\n\n## What type of regression is needed? {#sec-reg_type}\n\nOutput variable (aka the dependent variable, predicted variable) form determines the type of regression : \n\n|  |  |  |\n|----|----|----|\n| **Level of measurement of outcome variable** | **Two Independent Groups without Confounding Adjustment** | **Two Independent Groups without Confounding Adjustment** |\n| Dichotomous | Chi2 Test | **logistic regression** |\n| Unordered categorical | Chi2 Test | multinomial logistic regression |\n| Ordered categorical | Wilcoxon-Mann-Whitney | ordinal logistic regression |\n| Continuous (normally distributed) | T-test | **linear regression** |\n| Censored: time to event | Log-rank test | **Cox regression** |\n\nFrom: From: Stoddard GJ. Biostatistics and Epidemiology Using Stata: A Course Manual. Salt Lake City, UT: University of Utah School of Medicine.\n\n## How do you interpret the regression results? {#sec-reg_interp}\n\nRegression coefficient = What change in the outcome do you expected if you change the predictor by 1 unit, holding all other variables constant\n\n-   For linear regression: additive change in outcome\n-   For logistic regression: multiplicative change in odds of the outcome\n-   For Cox regression: multiplicative change in the hazard of the outcome. \n\nExample:\n\nConsider, if we want to test whether 'splenectomy' and 'got_cteph?' are associated, we could use a chi2 test:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#chi2_test_result <- chisq.test(darren_data_sheet$splenectomy, darren_data_sheet$`got_cteph?`)\n#print(chi2_test_result)\n```\n:::\n\n\nAlternatively you could specify a logistic regression\n\n(\"GLM\" standards for 'general linear model'. Logistic regression is a type of glm where the family is binomial)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#logistic_model <- glm(`got_cteph?` ~ splenectomy, data = darren_data_sheet, family = binomial())\n\n# Output the summary of the model to see coefficients and statistics\n#summary(logistic_model)\n```\n:::\n\n\n![Causal relationship of Splenectomy and CTEPH](images/Screenshot%202024-04-30%20at%209.11.26%20PM.png)\n\n(<https://www.dagitty.net/dags.html> Daggity is a tool to specify such diagrams)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#logistic_model_updated <- glm(`got_cteph?` ~ splenectomy + prox_v_dist, data = darren_data_sheet, family = binomial())\n#summary(logistic_model_updated)\n```\n:::\n\n\n![Causal diagram of Splenectomy, Prox_v_dist, and CTEPH](images/Screenshot%202024-04-30%20at%209.11.20%20PM.png)\n\nConsider: do you want the adjusted or the unadjusted estimate? \n\nHint: it depends....\n\nDistributions:\n\n![](images/clipboard-4048320043.png)\n\nRegressions -\n\n\\[ \\] create the linear regression interpretation and example.\n\nlogic of different choices… ie. “under the following assumptions this is the estimate” - thus, if you make different assumptions, you make a different answers. Therefore, knowing the assumptinos are very important for knowing whether the result is believable.\n\nModels - you choose a way to distill the relationships that are contingent on certain assumptions - and if those assumptions hold, your conclusions follow.\n\nDAGs What does it mean to control? https://idlhy0218.github.io/page%20building/blog.html#control\n\nConceptually - you are modeling something… all models are wrong, some models are useful. You just need to know the assumptions you are implying by your choice, so that you can make an argument about whether the assumptions are warranted or not .\n\n### Functional Forms\n\nFunctional forms \\*\\*\\* dichotomization vs flexible models\n\nWhat type of questions can regression be used? - controlling for the effect of one thing on another. - prediction\n\n--- how to do in python: python resources for how to do that section of it: https://ajthurston.com/predprobs?utm_source=substack&utm_medium=email\n\n![](images/clipboard-3990776221.png)\n\nTODO:\n\n-   pull in definition code.\n-   make links automatically.\n",
    "supporting": [
      "intro_regression_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}